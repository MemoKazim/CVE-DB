from colors import bcolors
import threading
import time

SOURCES = {
    1: "https://nvd.nist.gov/vuln/detail/CVE-XXXX-XXXX",
    2: "https://www.exploit-db.com/search?cve=XXXX-XXXX",
    3: "https://www.cve.org/CVERecord?id=CVE-XXXX-XXXX",
    4: "https://vulners.com/cve/CVE-XXXX-XXXX",
    5: "https://vulmon.com/vulnerabilitydetails?qid=CVE-XXXX-XXXX",
}

is_active = True

def wheel(source):
    print(f"{bcolors.FG_YELLOW}[│] Scrapping from {source}...", end="")
    while is_active:
        for _ in ["/", "─", "\\", "│"]:
            print(f"\r[{_}] Scrapping from {source}...", end="")
            time.sleep(0.1)
    print(f"\r{bcolors.FG_GREEN}[+] Scrapping from {source} FINISHED!{bcolors.END}")

def nist():
    # scrap from nist
    print("You got me NIST")
    time.sleep(3)
    pass

def exploitdb():
    # scrap from exploit db
    print("You got me EXPLOIT DB")
    time.sleep(3)
    pass

def mitre():
    # scrap from mitre
    print("You got me MITRE")
    time.sleep(3)
    pass

def vulners():
    # scrap from vulners
    print("You got me VULNERS")
    time.sleep(3)
    pass

def vulmon():
    # scrap from vulmon
    print("You got me VULMON")
    time.sleep(10)
    pass

def scrap(source, function):
    global is_active
    t1 = threading.Thread(target=function)
    t2 = threading.Thread(target=wheel,args=(source,))
    t1.start()
    t2.start()
    time.sleep(2)
    while t1.is_alive():
        pass
    is_active = False
    t2.join()
